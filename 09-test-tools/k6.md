# k6
> 참고 링크 : https://k6.io/

Grafana Labs에서 개발한 **오픈소스 부하 테스트 도구**.

사용하기가 쉽고, CI/CD 파이프라인에 통합하기에 최적화되어 있는 것이 주요 특징이다.

## 핵심 특징
### 1. Javascript 기반 스크립팅화
- 테스트 시나리오 작성 시 Javascript를 사용
- JMeter와 같이 XML 혹은 GUI를 다룰 필요 없이 코드로 테스트를 작성하고 버전을 관리할 수 있음
### 2. 가볍고 강력한 성능
- Go 언어로 작성되어 매우 가볍고 빠르다
- 적은 리소스로 많은 `Virtual Users`를 생성하여 높은 부하를 발생시킬 수 있음
### 3. 개발자 친화적 및 자동화 용이
- CLI 기반으로 동작하여 터미널에서 쉽게 실행 가능
- Jenkins, Github Actions 등 CI/CD 파이프라인에 쉽게 통합해 배포시 마다 자동으로 테스트를 돌릴 수 있음
### 4, 다양한 결과 시각
- 기본적으로 터미널에 요약된 결과를 보여줌
- Grafana, CloudWatch 등으로 대시보드를 구성할 수 있음

## 기본 구조
k6 스크립트는 크게 4가지 단계로 실행된다.
1. Init : 필요한 패키지를 import 하고 옵션을 설정한다.
2. Setup : 테스트 시작 전 한번만 실행됨 (e.g: 토큰 발급)
3. VU Code : 실제 부하를 주는 로직으로 `default function` 내부에 작성하며, 반복 실행 됨
4. Teardown : 테스트가 끝난 후 한 번만 실행됨

간단한 사용 예시
```javascript
import http from 'k6/http';
import { check, sleep } from 'k6';

// 1. 설정 (Options)
export const options = {
  vus: 10,           // 가상 유저 10명
  duration: '30s',   // 30초 동안 테스트 진행
  thresholds: {      // 성공/실패 기준 (SLA 설정)
    http_req_duration: ['p(95)<500'], // 95%의 요청이 500ms 이내여야 함
  },
};

// 2. VU 로직 (Main function)
export default function () {
  const res = http.get('http://test.k6.io');

  // 응답 확인 (Assertion)
  check(res, {
    'status is 200': (r) => r.status === 200,
  });

  sleep(1); // 1초 대기 (User Think Time 시뮬레이션)
}
```

## JMeter vs k6
| 특성    | JMeter     | k6                             |
|-------|------------|--------------------------------|
| 기반 언어 | Java       | Go (스크립트 : JS)                 |
| 인터페이스 | GUI        | CLI / Code                     |
| 성능    | 리소스 효율성 낮음 | 리소스 효율성 좋음                     |
| 보고서   | HTML 리포트   | Stdout, JSON, Grafana 등 실시간 전송 |