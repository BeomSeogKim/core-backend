# Page Split
InnoDB 기준 Page는 16KB로 고정되어있다.

Page에 16KB가 꽉 찼을 경우 페이지 분할이 발생한다.

동작 과정 (InnoDB)
- Insert 시도 : 새로운 데이터를 리프 노드에 넣으려고 하는 해당 페이지에 빈 공간 부족
- 새 페이지 할당 : 디스크에서 비어 있는 새로운 페이지 하나 확보
- 데이터 이동 : 기존 페이지에 존재하던 데이터의 약 50%를 새로운 페이지로 이동
- 데이터 삽입 : 확보된 공간에 새로운 데이터 삽입
- 부모 노드 갱신 : 부모 노드에 새로운 페이지를 가리키는 포인터와 Entry를 추가
    - 부모 노드도 다 차있다면 위로 전파

왜 문제인가?
1. 쓰기 폭증
    - 페이지 2개를 새로 쓰고, 부모 노드 갱신 작업도 진행 해야 함
2. 동시성 저하
    - 페이지들을 쪼개고 데이터를 옮기는 동안, 해당 페이지들은 잠금된다. (다른 트랜잭션들이 대기 해야 함)
3. 공간 낭비
    - 기존 100% 사용중이던 페이지 분할 시 50%씩만 사용하고 있는 페이지로 변경된다.

어떻게 넣어야 하는 가?
- 순차적인 키
    - 데이터가 항상 맨 뒤에 추가가 된다.
    - 마지막 페이지가 꽉 차면, 기존 데이터를 옮길 필요가 없이 새 페이지를 만들어 계속 할당하면 된다.
    - 중간 페이지를 쪼갤 일이 거의 없고, 디스크 공간 낭비도 적고 빠르다.

넣으면 안되는 방식은?
- UUID, Random String
    - 새 데이터가 들어올 위치가 **랜덤**이다.
    - 이미 꽉 차있는 중간 노드에 삽입 될 확률이 높음
    - 빈번한 Page Split 방식 -> IO 증가 -> 페이지 단편화 -> 버퍼 풀 효율 저하

=> 분산환경이라 어쩔 수 없는 경우 그래도 순차적인 키 특성을 가지고 있게끔 하기 위해 다음과 같은 방식들을 채택한다.
- UUID v7 : `Unix Timestamp` + `Random`
- ULID : `Timestamp` + 80 bit `Random`
- TSID : `Time` + `Node ID` + `Sequence`